<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Volume Analyzer - æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ åˆ†æãƒ„ãƒ¼ãƒ«</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-shadow { box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); }
        .loading-spinner { border: 3px solid #f3f3f3; border-top: 3px solid #667eea; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .keyword-tag { transition: all 0.2s ease; }
        .keyword-tag:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); }
        .site-card { transition: all 0.3s ease; }
        .site-card:hover { transform: translateY(-4px); box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15); }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">Search Volume Analyzer</h1>
                    <p class="text-purple-200 mt-1">AIãƒ‘ãƒ¯ãƒ¼ãƒ‰ã®æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æãƒ„ãƒ¼ãƒ«</p>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="bg-white/20 px-4 py-2 rounded-full text-sm">
                        <span class="inline-block w-2 h-2 bg-green-400 rounded-full mr-2 pulse"></span>
                        AIåˆ†æã‚¨ãƒ³ã‚¸ãƒ³ç¨¼åƒä¸­
                    </span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Search Input Section -->
        <section class="bg-white rounded-2xl card-shadow p-8 mb-8">
            <div class="max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦åˆ†æé–‹å§‹</h2>
                <div class="flex gap-4">
                    <div class="flex-1 relative">
                        <input type="text" id="keywordInput" placeholder="åˆ†æã—ãŸã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ï¼ˆä¾‹: ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° å­¦ç¿’ï¼‰" class="w-full px-6 py-4 text-lg border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none transition-colors">
                        <div id="suggestions" class="absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-xl mt-2 hidden z-10 shadow-lg"></div>
                    </div>
                    <button id="analyzeBtn" class="gradient-bg text-white px-8 py-4 rounded-xl font-semibold hover:opacity-90 transition-opacity flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        åˆ†æé–‹å§‹
                    </button>
                </div>
                <div class="mt-4 flex flex-wrap gap-2" id="recentSearches"><span class="text-sm text-gray-400">æœ€è¿‘ã®æ¤œç´¢å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“</span></div>
            </div>
        </section>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <!-- Volume Overview -->
            <section class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 fade-in">
                <div class="bg-white rounded-xl card-shadow p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-500 text-sm">æœˆé–“æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ </span>
                        <span class="bg-green-100 text-green-600 text-xs px-2 py-1 rounded-full">+12%</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="monthlyVolume">--</p>
                    <p class="text-xs text-gray-400 mt-1">éå»30æ—¥é–“</p>
                </div>
                <div class="bg-white rounded-xl card-shadow p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-500 text-sm">ç«¶åˆåº¦</span>
                        <span class="bg-yellow-100 text-yellow-600 text-xs px-2 py-1 rounded-full" id="competitionBadge">ä¸­</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="competition">--</p>
                    <p class="text-xs text-gray-400 mt-1">100ç‚¹æº€ç‚¹</p>
                </div>
                <div class="bg-white rounded-xl card-shadow p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-500 text-sm">CPCï¼ˆåºƒå‘Šå˜ä¾¡ï¼‰</span>
                        <span class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded-full">å‚è€ƒå€¤</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="cpc">--</p>
                    <p class="text-xs text-gray-400 mt-1">1ã‚¯ãƒªãƒƒã‚¯ã‚ãŸã‚Š</p>
                </div>
                <div class="bg-white rounded-xl card-shadow p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-500 text-sm">SEOé›£æ˜“åº¦</span>
                        <span class="bg-purple-100 text-purple-600 text-xs px-2 py-1 rounded-full" id="seoBadge">æ™®é€š</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="seoDifficulty">--</p>
                    <p class="text-xs text-gray-400 mt-1">100ç‚¹æº€ç‚¹</p>
                </div>
            </section>

            <!-- Main Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column -->
                <div class="lg:col-span-2 space-y-8">
                    <!-- Trend Chart -->
                    <section class="bg-white rounded-xl card-shadow p-6 fade-in">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-bold text-gray-800">æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒˆãƒ¬ãƒ³ãƒ‰</h3>
                            <div class="flex gap-2">
                                <button class="trend-period px-4 py-2 rounded-lg text-sm font-medium bg-purple-100 text-purple-600" data-period="12">12ãƒ¶æœˆ</button>
                                <button class="trend-period px-4 py-2 rounded-lg text-sm font-medium text-gray-500 hover:bg-gray-100" data-period="6">6ãƒ¶æœˆ</button>
                                <button class="trend-period px-4 py-2 rounded-lg text-sm font-medium text-gray-500 hover:bg-gray-100" data-period="3">3ãƒ¶æœˆ</button>
                            </div>
                        </div>
                        <div class="h-64"><canvas id="trendChart"></canvas></div>
                    </section>

                    <!-- Top Ranking Sites -->
                    <section class="bg-white rounded-xl card-shadow p-6 fade-in">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-bold text-gray-800">æ¤œç´¢ä¸Šä½ã‚µã‚¤ãƒˆ</h3>
                            <div class="flex gap-2">
                                <button class="sort-btn px-4 py-2 rounded-lg text-sm font-medium bg-purple-100 text-purple-600" data-sort="rank">æ¤œç´¢é †ä½é †</button>
                                <button class="sort-btn px-4 py-2 rounded-lg text-sm font-medium text-gray-500 hover:bg-gray-100" data-sort="traffic">æ¨å®šæµå…¥é †</button>
                            </div>
                        </div>
                        <div id="topSites" class="space-y-4"></div>
                    </section>
                </div>

                <!-- Right Column -->
                <div class="space-y-8">
                    <!-- Search Persona -->
                    <section class="bg-white rounded-xl card-shadow p-6 fade-in">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">æ¤œç´¢è€…ãƒšãƒ«ã‚½ãƒŠ</h3>
                        <div id="personaSection"></div>
                    </section>

                    <!-- Related Keywords -->
                    <section class="bg-white rounded-xl card-shadow p-6 fade-in">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold text-gray-800">é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</h3>
                            <span class="bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-3 py-1 rounded-full">AIææ¡ˆ</span>
                        </div>
                        <div id="relatedKeywords" class="flex flex-wrap gap-2"></div>
                    </section>

                    <!-- Search Intent -->
                    <section class="bg-white rounded-xl card-shadow p-6 fade-in">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">æ¤œç´¢æ„å›³ã®åˆ†æ</h3>
                        <div id="searchIntent"></div>
                    </section>

                    <!-- Seasonal Trends -->
                    <section class="bg-white rounded-xl card-shadow p-6 fade-in">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">å­£ç¯€æ€§ãƒˆãƒ¬ãƒ³ãƒ‰</h3>
                        <div class="h-40"><canvas id="seasonalChart"></canvas></div>
                    </section>
                </div>
            </div>
        </div>

        <!-- SEO Analysis Modal -->
        <div id="seoModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="p-6 border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold text-gray-800">SEOåˆ†æãƒ¬ãƒãƒ¼ãƒˆ</h3>
                        <button id="closeModal" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                        </button>
                    </div>
                </div>
                <div id="seoAnalysisContent" class="p-6"></div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="fixed inset-0 bg-white/80 flex items-center justify-center z-40 hidden">
            <div class="text-center">
                <div class="loading-spinner mx-auto mb-4"></div>
                <p class="text-gray-600 font-medium">AIãŒåˆ†æä¸­...</p>
                <p class="text-gray-400 text-sm mt-1" id="loadingMessage">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¦ã„ã¾ã™</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-8 mt-16">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm">Search Volume Analyzer - AIæ­è¼‰ã®é«˜åº¦ãªSEOåˆ†æãƒ„ãƒ¼ãƒ«</p>
            <p class="text-xs mt-2">ãƒ‡ãƒ¼ã‚¿ã¯å‚è€ƒå€¤ã§ã™ã€‚å®Ÿéš›ã®æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã¯ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
        </div>
    </footer>

    <script>
    // ========== SearchData Module ==========
    const SearchData = {
        categoryPatterns: {
            programming: ['ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', 'python', 'javascript', 'ã‚³ãƒ¼ãƒ‰', 'é–‹ç™º', 'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢', 'webé–‹ç™º'],
            marketing: ['ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°', 'seo', 'åºƒå‘Š', 'sns', 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', 'ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°'],
            business: ['ãƒ“ã‚¸ãƒã‚¹', 'èµ·æ¥­', 'å‰¯æ¥­', 'æŠ•è³‡', 'è»¢è·', 'ã‚­ãƒ£ãƒªã‚¢'],
            health: ['å¥åº·', 'ãƒ€ã‚¤ã‚¨ãƒƒãƒˆ', 'ç­‹ãƒˆãƒ¬', 'ç¾å®¹', 'ã‚¹ã‚­ãƒ³ã‚±ã‚¢', 'é£Ÿäº‹', 'ã‚ªãƒ ãƒ„', 'ãŠã‚€ã¤'],
            education: ['å­¦ç¿’', 'å‹‰å¼·', 'è³‡æ ¼', 'è‹±èª', 'ã‚¹ã‚­ãƒ«', 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³'],
            technology: ['ai', 'äººå·¥çŸ¥èƒ½', 'chatgpt', 'tech', 'ãƒ‡ã‚¸ã‚¿ãƒ«', 'iot'],
            lifestyle: ['æ—…è¡Œ', 'ã‚°ãƒ«ãƒ¡', 'ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³', 'è¶£å‘³', 'ã‚¤ãƒ³ãƒ†ãƒªã‚¢']
        },
        volumeRanges: {
            programming: { min: 50000, max: 500000 },
            marketing: { min: 30000, max: 300000 },
            business: { min: 80000, max: 600000 },
            health: { min: 100000, max: 800000 },
            education: { min: 60000, max: 400000 },
            technology: { min: 150000, max: 1000000 },
            lifestyle: { min: 70000, max: 500000 },
            default: { min: 20000, max: 200000 }
        },
        detectCategory(keyword) {
            const lowerKeyword = keyword.toLowerCase();
            for (const [category, patterns] of Object.entries(this.categoryPatterns)) {
                if (patterns.some(pattern => lowerKeyword.includes(pattern))) return category;
            }
            return 'default';
        },
        hashCode(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash);
        },
        seededRandom(seed) {
            const x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        },
        generateMonthlyVolume(keyword) {
            const category = this.detectCategory(keyword);
            const range = this.volumeRanges[category];
            const hash = this.hashCode(keyword);
            const volume = Math.floor(range.min + (range.max - range.min) * this.seededRandom(hash));
            return Math.round(volume / 1000) * 1000;
        },
        generateCompetition(keyword) { return Math.floor(this.seededRandom(this.hashCode(keyword + 'c')) * 100); },
        generateCPC(keyword) { return Math.round(50 + this.seededRandom(this.hashCode(keyword + 'p')) * 450); },
        generateSEODifficulty(keyword) { return Math.floor(this.seededRandom(this.hashCode(keyword + 's')) * 100); },
        generateTrendData(keyword, months = 12) {
            const baseVolume = this.generateMonthlyVolume(keyword);
            const hash = this.hashCode(keyword);
            const data = [], labels = [];
            const now = new Date();
            for (let i = months - 1; i >= 0; i--) {
                const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
                labels.push(`${date.getFullYear()}/${date.getMonth() + 1}`);
                const seasonalFactor = 1 + 0.2 * Math.sin((date.getMonth() / 12) * Math.PI * 2);
                const randomFactor = 0.8 + this.seededRandom(hash + i) * 0.4;
                data.push(Math.floor(baseVolume * seasonalFactor * randomFactor));
            }
            return { labels, data };
        },
        generateSeasonalData(keyword) {
            const hash = this.hashCode(keyword);
            const months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
            const data = months.map((_, i) => Math.floor(50 + this.seededRandom(hash + i) * 50 + 20 * Math.sin((i / 12) * Math.PI * 2)));
            return { labels: months, data };
        },
        generateRelatedKeywords(keyword) {
            const category = this.detectCategory(keyword);
            const relatedTerms = {
                programming: ['å…¥é–€', 'ç‹¬å­¦', 'ã‚¹ã‚¯ãƒ¼ãƒ«', 'ãŠã™ã™ã‚', 'åˆå¿ƒè€…', 'å­¦ç¿’æ–¹æ³•', 'ç„¡æ–™', 'è³‡æ ¼'],
                marketing: ['æˆ¦ç•¥', 'æˆåŠŸäº‹ä¾‹', 'ãƒ„ãƒ¼ãƒ«', 'åŸºç¤', 'æœ€æ–°ãƒˆãƒ¬ãƒ³ãƒ‰', 'BtoB', 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', 'SNSæ´»ç”¨'],
                health: ['æ–¹æ³•', 'åŠ¹æœ', 'å£ã‚³ãƒŸ', 'ãŠã™ã™ã‚', 'èµ¤ã¡ã‚ƒã‚“', 'æ¯”è¼ƒ', 'ã‚µã‚¤ã‚º', 'äººæ°—'],
                default: ['ã¨ã¯', 'æ–¹æ³•', 'ã‚„ã‚Šæ–¹', 'ã‚³ãƒ„', 'ãŠã™ã™ã‚', 'æ¯”è¼ƒ', 'å£ã‚³ãƒŸ', 'è©•åˆ¤']
            };
            const terms = relatedTerms[category] || relatedTerms.default;
            const hash = this.hashCode(keyword);
            return terms.map((term, i) => ({
                keyword: `${keyword} ${term}`,
                volume: Math.round(this.generateMonthlyVolume(keyword) * (0.1 + this.seededRandom(hash + i) * 0.5) / 100) * 100,
                trend: ['up', 'down', 'stable'][Math.floor(this.seededRandom(hash + i + 100) * 3)]
            })).sort((a, b) => b.volume - a.volume);
        },
        generatePersona(keyword) {
            const category = this.detectCategory(keyword);
            const personas = {
                health: { age: ['20ä»£: 25%', '30ä»£: 35%', '40ä»£: 25%', '50ä»£ä»¥ä¸Š: 15%'], gender: { male: 35, female: 65 }, occupation: ['ä¼šç¤¾å“¡', 'ä¸»å©¦/ä¸»å¤«', 'è‚²å…ä¸­ã®è¦ª', 'ã‚·ãƒ‹ã‚¢'], motivation: 'å®¶æ—ã®å¥åº·ãƒ»è‚²å…ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å¾—ãŸã„', devices: { mobile: 70, desktop: 20, tablet: 10 } },
                programming: { age: ['20ä»£: 45%', '30ä»£: 35%', '40ä»£: 15%', 'ãã®ä»–: 5%'], gender: { male: 70, female: 30 }, occupation: ['ä¼šç¤¾å“¡ï¼ˆITï¼‰', 'å­¦ç”Ÿ', 'ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹', 'è»¢è·å¸Œæœ›è€…'], motivation: 'æ–°ã—ã„ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¦ã‚­ãƒ£ãƒªã‚¢ã®å¯èƒ½æ€§ã‚’åºƒã’ãŸã„', devices: { mobile: 35, desktop: 60, tablet: 5 } },
                default: { age: ['20ä»£: 30%', '30ä»£: 30%', '40ä»£: 25%', '50ä»£ä»¥ä¸Š: 15%'], gender: { male: 50, female: 50 }, occupation: ['ä¼šç¤¾å“¡', 'å­¦ç”Ÿ', 'ä¸»å©¦/ä¸»å¤«', 'ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹'], motivation: 'å¿…è¦ãªæƒ…å ±ã‚’åŠ¹ç‡çš„ã«å¾—ãŸã„', devices: { mobile: 55, desktop: 35, tablet: 10 } }
            };
            return personas[category] || personas.default;
        },
        analyzeSearchIntent(keyword) {
            const hash = this.hashCode(keyword);
            const r1 = Math.floor(this.seededRandom(hash) * 30) + 30;
            const r2 = Math.floor(this.seededRandom(hash + 1) * 30) + 20;
            return [
                { type: 'informational', label: 'æƒ…å ±åé›†', percentage: r1, color: 'blue' },
                { type: 'commercial', label: 'æ¯”è¼ƒæ¤œè¨', percentage: r2, color: 'purple' },
                { type: 'transactional', label: 'è³¼è²·ç›®çš„', percentage: 100 - r1 - r2, color: 'orange' }
            ].sort((a, b) => b.percentage - a.percentage);
        },
        generateTopSites(keyword) {
            const hash = this.hashCode(keyword);
            const sites = [
                { domain: 'amazon.co.jp', name: 'Amazon', type: 'ECã‚µã‚¤ãƒˆ' },
                { domain: 'rakuten.co.jp', name: 'æ¥½å¤©å¸‚å ´', type: 'ECã‚µã‚¤ãƒˆ' },
                { domain: 'yahoo.co.jp', name: 'Yahoo! JAPAN', type: 'ãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆ' },
                { domain: 'wikipedia.org', name: 'Wikipedia', type: 'ç™¾ç§‘äº‹å…¸' },
                { domain: 'note.com', name: 'note', type: 'ãƒ–ãƒ­ã‚°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ' },
                { domain: 'allabout.co.jp', name: 'All About', type: 'ç·åˆæƒ…å ±ã‚µã‚¤ãƒˆ' },
                { domain: 'mybest.com', name: 'ãƒã‚¤ãƒ™ã‚¹ãƒˆ', type: 'æ¯”è¼ƒã‚µã‚¤ãƒˆ' },
                { domain: 'ä¾¡æ ¼.com', name: 'ä¾¡æ ¼.com', type: 'æ¯”è¼ƒã‚µã‚¤ãƒˆ' },
                { domain: 'cozre.jp', name: 'ã‚³ã‚ºãƒ¬', type: 'è‚²å…ãƒ¡ãƒ‡ã‚£ã‚¢' },
                { domain: 'mamari.jp', name: 'ãƒãƒãƒª', type: 'è‚²å…ãƒ¡ãƒ‡ã‚£ã‚¢' }
            ];
            return sites.map((site, i) => ({
                rank: i + 1, domain: site.domain, name: site.name, type: site.type,
                title: `${keyword}${['ã®å®Œå…¨ã‚¬ã‚¤ãƒ‰', 'ã¨ã¯ï¼Ÿåˆå¿ƒè€…å‘ã‘è§£èª¬', 'å¾¹åº•è§£èª¬', 'ã¾ã¨ã‚', 'ã®åŸºç¤çŸ¥è­˜'][i % 5]}`,
                traffic: Math.floor(this.seededRandom(hash + i) * 50000) + 5000,
                authority: Math.floor(60 + this.seededRandom(hash + i + 100) * 40),
                backlinks: Math.floor(1000 + this.seededRandom(hash + i + 200) * 50000),
                wordCount: Math.floor(1500 + this.seededRandom(hash + i + 300) * 8000),
                lastUpdated: new Date(Date.now() - Math.floor(this.seededRandom(hash + i + 400) * 90) * 86400000).toLocaleDateString('ja-JP'),
                seoFactors: {
                    titleOptimization: Math.floor(70 + this.seededRandom(hash + i + 500) * 30),
                    contentQuality: Math.floor(70 + this.seededRandom(hash + i + 600) * 30),
                    backlinks: Math.floor(60 + this.seededRandom(hash + i + 700) * 40),
                    userExperience: Math.floor(65 + this.seededRandom(hash + i + 800) * 35),
                    technicalSEO: Math.floor(70 + this.seededRandom(hash + i + 900) * 30)
                }
            }));
        }
    };

    // ========== ChartManager Module ==========
    const ChartManager = {
        trendChart: null, seasonalChart: null,
        updateTrendChart(labels, data) {
            const ctx = document.getElementById('trendChart').getContext('2d');
            if (this.trendChart) this.trendChart.destroy();
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, 'rgba(102, 126, 234, 0.5)');
            gradient.addColorStop(1, 'rgba(102, 126, 234, 0.0)');
            this.trendChart = new Chart(ctx, {
                type: 'line',
                data: { labels, datasets: [{ label: 'æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ ', data, borderColor: '#667eea', backgroundColor: gradient, borderWidth: 3, fill: true, tension: 0.4, pointRadius: 4, pointBackgroundColor: '#667eea', pointBorderColor: '#fff', pointBorderWidth: 2 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { callbacks: { label: ctx => 'æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ : ' + ctx.raw.toLocaleString() } } }, scales: { x: { grid: { display: false } }, y: { ticks: { callback: v => v >= 1000 ? (v/1000).toFixed(0) + 'K' : v } } } }
            });
        },
        updateSeasonalChart(labels, data) {
            const ctx = document.getElementById('seasonalChart').getContext('2d');
            if (this.seasonalChart) this.seasonalChart.destroy();
            this.seasonalChart = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets: [{ data, backgroundColor: data.map((_, i) => `hsla(${260 + i * 8}, 70%, 60%, 0.7)`), borderRadius: 4 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false } }, y: { display: false, min: 0, max: 100 } } }
            });
        }
    };

    // ========== AIAnalysis Module ==========
    const AIAnalysis = {
        generateSEOAnalysis(site, keyword) {
            return {
                overview: `ã€Œ${site.name}ã€ã¯ã€Œ${keyword}ã€ã®æ¤œç´¢çµæœã§${site.rank}ä½ã«ãƒ©ãƒ³ã‚¯ã‚¤ãƒ³ã€‚DA ${site.authority}ã€${site.backlinks.toLocaleString()}ä»¶ã®ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ã€‚`,
                rankingFactors: [
                    { name: 'ã‚¿ã‚¤ãƒˆãƒ«æœ€é©åŒ–', score: site.seoFactors.titleOptimization, icon: 'ğŸ“' },
                    { name: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å“è³ª', score: site.seoFactors.contentQuality, icon: 'ğŸ“„' },
                    { name: 'ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯', score: site.seoFactors.backlinks, icon: 'ğŸ”—' },
                    { name: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“', score: site.seoFactors.userExperience, icon: 'ğŸ‘¥' },
                    { name: 'æŠ€è¡“çš„SEO', score: site.seoFactors.technicalSEO, icon: 'âš™ï¸' }
                ],
                strengths: site.authority >= 70 ? [{ title: 'é«˜ã„ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ¼ã‚½ãƒªãƒ†ã‚£', description: `DA ${site.authority}ã¯æ¥­ç•Œãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹` }] : [{ title: 'å®‰å®šã—ãŸãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹', description: 'ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸSEOå¯¾ç­–' }],
                improvements: [{ priority: 'ä¸­', title: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–°', description: 'å®šæœŸçš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–°ã§é®®åº¦ã‚’ä¿ã¤', impact: 'é•·æœŸçš„ãªå®‰å®š' }],
                contentAnalysis: { wordCount: site.wordCount, readingTime: Math.ceil(site.wordCount / 400) }
            };
        },
        generateReportHTML(analysis, site) {
            return `
                <div class="space-y-6">
                    <div><h4 class="text-lg font-semibold mb-3">ğŸ“Š åˆ†ææ¦‚è¦</h4><p class="text-gray-600">${analysis.overview}</p></div>
                    <div><h4 class="text-lg font-semibold mb-3">ğŸ¯ ãªãœã“ã®ã‚µã‚¤ãƒˆãŒä¸Šä½è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã‹</h4>
                    <div class="space-y-3">${analysis.rankingFactors.map(f => `
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex justify-between mb-2"><span>${f.icon} ${f.name}</span><span class="${f.score >= 80 ? 'text-green-600' : 'text-yellow-600'}">${f.score}/100</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full ${f.score >= 80 ? 'bg-green-500' : 'bg-yellow-500'}" style="width:${f.score}%"></div></div>
                        </div>`).join('')}</div></div>
                    <div><h4 class="text-lg font-semibold mb-3">ğŸ’ª ã“ã®ã‚µã‚¤ãƒˆã®å¼·ã¿</h4>
                    ${analysis.strengths.map(s => `<div class="bg-green-50 border border-green-100 rounded-lg p-4"><h5 class="font-medium text-green-800">${s.title}</h5><p class="text-sm text-green-700 mt-1">${s.description}</p></div>`).join('')}</div>
                    <div><h4 class="text-lg font-semibold mb-3">ğŸ“ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©³ç´°</h4>
                    <div class="grid grid-cols-2 gap-4"><div class="bg-gray-50 rounded-lg p-3 text-center"><p class="text-2xl font-bold">${analysis.contentAnalysis.wordCount.toLocaleString()}</p><p class="text-xs text-gray-500">æ–‡å­—æ•°</p></div><div class="bg-gray-50 rounded-lg p-3 text-center"><p class="text-2xl font-bold">${analysis.contentAnalysis.readingTime}åˆ†</p><p class="text-xs text-gray-500">èª­äº†æ™‚é–“</p></div></div></div>
                </div>`;
        }
    };

    // ========== App Module ==========
    const App = {
        currentKeyword: '', currentSites: [], recentSearches: [],
        init() {
            this.loadRecentSearches();
            this.setupEventListeners();
            this.renderRecentSearches();
            console.log('Search Volume Analyzer initialized!');
        },
        setupEventListeners() {
            document.getElementById('analyzeBtn').addEventListener('click', () => this.analyze());
            document.getElementById('keywordInput').addEventListener('keypress', e => { if (e.key === 'Enter') this.analyze(); });
            document.querySelectorAll('.trend-period').forEach(btn => btn.addEventListener('click', e => {
                document.querySelectorAll('.trend-period').forEach(b => { b.classList.remove('bg-purple-100', 'text-purple-600'); b.classList.add('text-gray-500'); });
                e.target.classList.add('bg-purple-100', 'text-purple-600'); e.target.classList.remove('text-gray-500');
                this.updateTrendChart(parseInt(e.target.dataset.period));
            }));
            document.querySelectorAll('.sort-btn').forEach(btn => btn.addEventListener('click', e => {
                document.querySelectorAll('.sort-btn').forEach(b => { b.classList.remove('bg-purple-100', 'text-purple-600'); b.classList.add('text-gray-500'); });
                e.target.classList.add('bg-purple-100', 'text-purple-600'); e.target.classList.remove('text-gray-500');
                this.sortAndRenderSites(e.target.dataset.sort);
            }));
            document.getElementById('closeModal').addEventListener('click', () => this.closeModal());
            document.getElementById('seoModal').addEventListener('click', e => { if (e.target.id === 'seoModal') this.closeModal(); });
        },
        async analyze() {
            const keyword = document.getElementById('keywordInput').value.trim();
            if (!keyword) { alert('ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
            this.currentKeyword = keyword;
            this.showLoading(true);
            this.saveRecentSearch(keyword);
            await new Promise(r => setTimeout(r, 1200));
            this.displayResults(SearchData.generateMonthlyVolume(keyword), SearchData.generateCompetition(keyword), SearchData.generateCPC(keyword), SearchData.generateSEODifficulty(keyword));
            this.updateTrendChart(12);
            const seasonal = SearchData.generateSeasonalData(keyword);
            ChartManager.updateSeasonalChart(seasonal.labels, seasonal.data);
            this.displayRelatedKeywords();
            this.displayPersona();
            this.displaySearchIntent();
            this.currentSites = SearchData.generateTopSites(keyword);
            this.renderSites();
            document.getElementById('resultsSection').classList.remove('hidden');
            this.showLoading(false);
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        },
        showLoading(show) { document.getElementById('loadingOverlay').classList.toggle('hidden', !show); },
        displayResults(volume, competition, cpc, seoDifficulty) {
            document.getElementById('monthlyVolume').textContent = volume.toLocaleString();
            document.getElementById('competition').textContent = competition;
            const compBadge = document.getElementById('competitionBadge');
            compBadge.textContent = competition >= 70 ? 'é«˜' : competition >= 40 ? 'ä¸­' : 'ä½';
            compBadge.className = `text-xs px-2 py-1 rounded-full ${competition >= 70 ? 'bg-red-100 text-red-600' : competition >= 40 ? 'bg-yellow-100 text-yellow-600' : 'bg-green-100 text-green-600'}`;
            document.getElementById('cpc').textContent = 'Â¥' + cpc;
            document.getElementById('seoDifficulty').textContent = seoDifficulty;
            const seoBadge = document.getElementById('seoBadge');
            seoBadge.textContent = seoDifficulty >= 70 ? 'é›£' : seoDifficulty >= 40 ? 'æ™®é€š' : 'æ˜“';
            seoBadge.className = `text-xs px-2 py-1 rounded-full ${seoDifficulty >= 70 ? 'bg-red-100 text-red-600' : seoDifficulty >= 40 ? 'bg-yellow-100 text-yellow-600' : 'bg-green-100 text-green-600'}`;
        },
        updateTrendChart(months) { const trend = SearchData.generateTrendData(this.currentKeyword, months); ChartManager.updateTrendChart(trend.labels, trend.data); },
        displayRelatedKeywords() {
            const keywords = SearchData.generateRelatedKeywords(this.currentKeyword);
            document.getElementById('relatedKeywords').innerHTML = keywords.map(kw => `<button class="keyword-tag bg-purple-50 text-purple-700 px-3 py-2 rounded-lg text-sm hover:bg-purple-100 flex items-center gap-2" onclick="App.searchKeyword('${kw.keyword}')"><span>${kw.keyword}</span><span class="text-xs text-gray-400">${(kw.volume/1000).toFixed(1)}K</span><span class="${kw.trend === 'up' ? 'text-green-500' : kw.trend === 'down' ? 'text-red-500' : 'text-gray-400'} text-xs">${kw.trend === 'up' ? 'â†‘' : kw.trend === 'down' ? 'â†“' : 'â†’'}</span></button>`).join('');
        },
        displayPersona() {
            const p = SearchData.generatePersona(this.currentKeyword);
            document.getElementById('personaSection').innerHTML = `
                <div class="space-y-4">
                    <div><h4 class="text-sm font-medium text-gray-600 mb-2">å¹´é½¢å±¤</h4><div class="space-y-1">${p.age.map(age => { const [label, pct] = age.split(': '); return `<div class="flex items-center text-sm"><span class="w-20 text-gray-500">${label}</span><div class="flex-1 bg-gray-100 rounded-full h-2 mx-2"><div class="bg-purple-500 h-2 rounded-full" style="width:${parseInt(pct)}%"></div></div><span class="text-gray-600 w-10 text-right">${pct}</span></div>`; }).join('')}</div></div>
                    <div><h4 class="text-sm font-medium text-gray-600 mb-2">æ€§åˆ¥</h4><div class="flex gap-4"><div class="flex-1 bg-blue-50 rounded-lg p-3 text-center"><span class="text-2xl">ğŸ‘¨</span><p class="text-lg font-bold text-blue-600">${p.gender.male}%</p></div><div class="flex-1 bg-pink-50 rounded-lg p-3 text-center"><span class="text-2xl">ğŸ‘©</span><p class="text-lg font-bold text-pink-600">${p.gender.female}%</p></div></div></div>
                    <div><h4 class="text-sm font-medium text-gray-600 mb-2">ä¸»ãªè·æ¥­</h4><div class="flex flex-wrap gap-2">${p.occupation.map(o => `<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs">${o}</span>`).join('')}</div></div>
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4"><h4 class="text-sm font-medium text-gray-600 mb-1">æ¤œç´¢ã®å‹•æ©Ÿ</h4><p class="text-sm text-gray-700">${p.motivation}</p></div>
                </div>`;
        },
        displaySearchIntent() {
            const intents = SearchData.analyzeSearchIntent(this.currentKeyword);
            const colorMap = { blue: 'bg-blue-500', green: 'bg-green-500', orange: 'bg-orange-500', purple: 'bg-purple-500' };
            document.getElementById('searchIntent').innerHTML = `<div class="space-y-3">${intents.map(i => `<div><div class="flex justify-between text-sm mb-1"><span class="text-gray-600">${i.label}</span><span class="font-medium">${i.percentage}%</span></div><div class="w-full bg-gray-100 rounded-full h-3"><div class="${colorMap[i.color]} h-3 rounded-full" style="width:${i.percentage}%"></div></div></div>`).join('')}</div>`;
        },
        renderSites() {
            document.getElementById('topSites').innerHTML = this.currentSites.map(site => `
                <div class="site-card bg-gray-50 rounded-xl p-4 border border-gray-100">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-3">
                                <span class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center font-bold text-sm">${site.rank}</span>
                                <div><h4 class="font-medium text-gray-800">${site.name}</h4><p class="text-xs text-gray-400">${site.domain}</p></div>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">${site.title}</p>
                            <div class="flex flex-wrap gap-3 mt-3 text-xs text-gray-500">
                                <span>ğŸ‘ ${site.traffic.toLocaleString()}/æœˆ</span>
                                <span>ğŸ”— DA: ${site.authority}</span>
                                <span>ğŸ“„ ${site.wordCount.toLocaleString()}æ–‡å­—</span>
                            </div>
                        </div>
                        <button onclick="App.openSEOAnalysis(${site.rank - 1})" class="ml-4 gradient-bg text-white px-4 py-2 rounded-lg text-sm font-medium hover:opacity-90">ğŸ’¡ AIåˆ†æ</button>
                    </div>
                </div>`).join('');
        },
        sortAndRenderSites(type) { this.currentSites.sort((a, b) => type === 'traffic' ? b.traffic - a.traffic : a.rank - b.rank); this.renderSites(); },
        openSEOAnalysis(idx) {
            const site = this.currentSites[idx];
            const analysis = AIAnalysis.generateSEOAnalysis(site, this.currentKeyword);
            document.getElementById('seoAnalysisContent').innerHTML = AIAnalysis.generateReportHTML(analysis, site);
            document.getElementById('seoModal').classList.remove('hidden');
        },
        closeModal() { document.getElementById('seoModal').classList.add('hidden'); },
        searchKeyword(kw) { document.getElementById('keywordInput').value = kw; this.analyze(); },
        saveRecentSearch(kw) {
            this.recentSearches = this.recentSearches.filter(k => k !== kw);
            this.recentSearches.unshift(kw);
            this.recentSearches = this.recentSearches.slice(0, 5);
            try { localStorage.setItem('recentSearches', JSON.stringify(this.recentSearches)); } catch(e) {}
            this.renderRecentSearches();
        },
        loadRecentSearches() { try { this.recentSearches = JSON.parse(localStorage.getItem('recentSearches')) || []; } catch(e) { this.recentSearches = []; } },
        renderRecentSearches() {
            const c = document.getElementById('recentSearches');
            c.innerHTML = this.recentSearches.length === 0 ? '<span class="text-sm text-gray-400">æœ€è¿‘ã®æ¤œç´¢å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“</span>' : `<span class="text-sm text-gray-500">æœ€è¿‘ã®æ¤œç´¢:</span>${this.recentSearches.map(k => `<button onclick="App.searchKeyword('${k}')" class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm hover:bg-gray-200">${k}</button>`).join('')}`;
        }
    };

    document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
